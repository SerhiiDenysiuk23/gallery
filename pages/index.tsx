import Head from "next/head";
import {Inter} from "next/font/google";
import {useEffect, useState} from "react";
import Header from "@/pages/components/Header";

const inter = Inter({subsets: ["latin"]});

const imageExt = ['jpg', 'jpeg', 'png', 'gif', 'webp']
const videoExt = ['mp4', 'mov', 'avi', 'mkv']

export default function Home() {
  const [fileList, setFileList] = useState<string[]>([])
  useEffect(() => {
    fetch("/api/getPublicList").then(res => res.json()).then(res => {
      setFileList(res.files)
    })
  }, []);

  console.log(fileList)

  return (
    <>
      <Head>
        <title>Create Next App</title>
        <meta name="description" content="Generated by create next app"/>
        <meta name="viewport" content="width=device-width, initial-scale=1"/>
        <link rel="icon" href="/favicon.ico"/>
      </Head>
      <Header/>
      <main className={`${inter.className}`}>
        {
          fileList.length > 0 &&
          fileList.map(item => <div>
            {
              imageExt.includes(item.split(".")[1].toLowerCase())
                ? <img src={`/${item}`} alt=""/>
                :       <video className={'video'} autoPlay muted loop>
                  <source src={`/${item}`} type="video/mp4"/>
                </video>
            }
          </div>)
        }
      </main>
    </>
  );
}
